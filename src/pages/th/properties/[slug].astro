---
import Base from "../../../layouts/BaseLayout.astro";
import { loadPropBySlug, loadProps } from "../../../lib/loadProps";

export async function getStaticPaths() {
  const slugs = [
    'park-villa-privatpool',
    'luxury-condo-pattaya', 
    'family-house-naklua',
    'modern-apartment-central'
  ];
  return slugs.map(slug => ({
    params: { slug },
    props: { slug }
  }));
}

const { slug } = Astro.props;
const p = await loadPropBySlug('th', slug);
if (!p) throw new Error("Property not found: " + slug);

// SEO-optimized Title and Description (Thai)
const seoTitle = `${p.title} - ${p.type} ใน ${p.location} | Weib-Coding อสังหาฯ พัทยา`;
const seoDescription = `${p.title} - ${p.type} ใน ${p.location}, ประเทศไทย. ${p.bedrooms} ห้องนอน, ${p.living_sqm ? p.living_sqm + 'ตร.ม. พื้นที่ใช้สอย' : ''} ราคา ${new Intl.NumberFormat('th-TH').format(p.price_thb)} บาท. บริการอสังหาริมทรัพย์มืออาชีพในพัทยา.`;
---
<Base lang="th" title={seoTitle} description={seoDescription} image={p.cover}>
  <article class="prose max-w-none">
    <h1>{p.title}</h1>
    <p class="text-sm text-gray-600">{p.location} · {p.type} · {p.bedrooms} ห้องนอน</p>
    <div class="grid md:grid-cols-2 gap-4 my-6">
      {p.images?.map(src => <img src={src} alt={p.title} class="w-full rounded-lg" />)}
    </div>
    <h2>ข้อมูลและข้อเท็จจริง</h2>
    <ul>
      <li>ราคา: {new Intl.NumberFormat('th-TH').format(p.price_thb)} บาท</li>
      {p.living_sqm && <li>พื้นที่ใช้สอย: {p.living_sqm} ตร.ม.</li>}
      {p.land_sqm && <li>ที่ดิน: {p.land_sqm} ตร.ม.</li>}
      {p.ownership && <li>กรรมสิทธิ์: {p.ownership}</li>}
      {p.features?.length ? <li>คุณสมบัติ: {p.features.join(", ")}</li> : null}
    </ul>
    {p.body && <>
      <h2>คำอธิบาย</h2>
      <p set:html={p.body.replace(/\n/g,'<br/>')}></p>
    </>}
  </article>
</Base>
